"use strict";(self.webpackChunkStudyApp=self.webpackChunkStudyApp||[]).push([[236],{6236:(y,d,a)=>{a.r(d),a.d(d,{QuizSelectionModule:()=>F});var c=a(177),f=a(7513),p=a(7166),r=function(t){return t.INVALID_FILE_TYPE="Invalid file type. Please upload a JSON file.",t.FILE_ALREADY_UPLOADED="This file has already been uploaded.",t.JSON_PARSE_ERROR="Error parsing JSON file. Please upload a valid JSON file.",t.INVALID_QUIZ_FORMAT_MISSING_QUESTIONS='Invalid quiz format: "questions" property is missing or is not an array.',t.QUIZ_CONTAINS_NO_QUESTIONS="The quiz file contains no questions.",t.INVALID_QUIZ_FORMAT_MISSING_PROPERTIES='Invalid quiz format: Each question must have "prompt", "options", and "answer" properties.',t.INVALID_QUIZ_FORMAT_INSUFFICIENT_OPTIONS="Invalid quiz format: Each question must have at least two options.",t.INVALID_QUIZ_FORMAT_ANSWER_NOT_IN_OPTIONS="Invalid quiz format: Each question's answer must be one of its options.",t.EXCEEDS_QUESTION_LIMIT="Cannot add any more questions: Total number of questions exceeds the limit of ",t.MAX_QUESTIONS_REACHED="Cannot add any more questions: Max number of questions has been reached.",t}(r||{}),e=a(8699),m=a(6629);let _=(()=>{class t{transform(s,i){return s?(s=s.trim()).length>i?s.substring(0,i)+"...":s:""}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=e.EJ8({name:"truncate",type:t,pure:!0})}}return t})();const S=["fileInput"];function g(t,u){if(1&t&&(e.j41(0,"div",12)(1,"h6",13),e.EFF(2),e.k0s()()),2&t){const s=e.XpG();e.R7$(2),e.SpI(" ",s.errorMessage," ")}}function N(t,u){if(1&t){const s=e.RV6();e.j41(0,"li",18)(1,"div",19)(2,"span",20),e.EFF(3),e.nI1(4,"truncate"),e.k0s(),e.j41(5,"i",21),e.bIt("click",function(){const o=e.eBV(s).$implicit,l=e.XpG(2);return e.Njj(l.removeFile(o.key))}),e.k0s()()()}if(2&t){const s=u.$implicit,i=e.XpG(2);e.R7$(3),e.Lme("",e.i5U(4,2,s.key,i.TRUNCATE_LIMIT)," - Questions: ",s.value.length,"")}}function T(t,u){if(1&t&&(e.j41(0,"div",14)(1,"h3",15),e.EFF(2,"Uploaded Files:"),e.k0s(),e.j41(3,"ul",16),e.DNE(4,N,6,5,"li",17),e.nI1(5,"keyvalue"),e.k0s()()),2&t){const s=e.XpG();e.R7$(4),e.Y8G("ngForOf",e.bMT(5,1,s.quizzes))}}function E(t,u){if(1&t&&(e.j41(0,"div",22)(1,"h4",23),e.EFF(2),e.k0s()()),2&t){const s=e.XpG();e.R7$(2),e.SpI("Loaded Questions: ",s.questions.length,"")}}const O=[{path:"",component:(()=>{class t{constructor(s,i){this.quizService=s,this.router=i,this.MAX_QUESTIONS=100,this.TRUNCATE_LIMIT=35,this.questions=[],this.quizzes=new Map,this.errorMessage="",this.quizService.setQuestions([])}onFileSelected(s){const i=s.target;if(!i.files||!i.files?.length)return void(this.errorMessage="");const n=Array.from(i.files);for(const o of n)if(this.errorMessage=this.validateFile(o),this.errorMessage)return;for(const o of n){const l=new FileReader;l.readAsText(o),l.onload=()=>{try{const I=JSON.parse(l.result);if(this.errorMessage=this.validateQuiz(I),this.errorMessage)return;const h=I.questions.map(M=>new p.v(M));this.questions.push(...h),this.quizzes.set(o.name,h),this.questions.length>=this.MAX_QUESTIONS&&(this.errorMessage=r.MAX_QUESTIONS_REACHED)}catch(I){console.error("Error parsing JSON:",I),this.errorMessage=r.JSON_PARSE_ERROR}}}}validateFile(s){let i="";return"application/json"===s.type||s.name.endsWith(".json")?this.quizzes.has(s.name)&&(i=r.FILE_ALREADY_UPLOADED):i=r.INVALID_FILE_TYPE,i}validateQuiz(s){let i="";switch(!0){case!s.questions||!Array.isArray(s.questions):i=r.INVALID_QUIZ_FORMAT_MISSING_QUESTIONS;break;case 0===s.questions.length:i=r.QUIZ_CONTAINS_NO_QUESTIONS;break;case!s.questions.every(n=>n.prompt&&n.options&&n.answer):i=r.INVALID_QUIZ_FORMAT_MISSING_PROPERTIES;break;case!s.questions.every(n=>Array.isArray(n.options)&&n.options.length>=2):i=r.INVALID_QUIZ_FORMAT_INSUFFICIENT_OPTIONS;break;case!s.questions.every(n=>n.options.includes(n.answer)):i=r.INVALID_QUIZ_FORMAT_ANSWER_NOT_IN_OPTIONS;break;case this.questions.length+s.questions.length>this.MAX_QUESTIONS:i=`${r.EXCEEDS_QUESTION_LIMIT}${this.MAX_QUESTIONS}.`}return i}clearFiles(){0!==this.quizzes.size&&(this.quizzes.clear(),this.questions=[],this.errorMessage="",this.fileInput.nativeElement.value="")}startQuiz(){0!==this.questions.length&&(this.quizService.setQuestions(this.questions),this.router.navigate(["/quiz"]))}removeFile(s){const i=this.quizzes.get(s);i&&(this.questions=this.questions.filter(n=>!i.includes(n)),this.quizzes.delete(s),this.errorMessage="",this.fileInput.nativeElement.value="")}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(m.p),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-quiz-selection"]],viewQuery:function(i,n){if(1&i&&e.GBs(S,5),2&i){let o;e.mGM(o=e.lsd())&&(n.fileInput=o.first)}},decls:15,vars:6,consts:[[1,"grid"],[1,"row"],[1,"col-12","h1","text-center","my-3"],[1,"col-12","offset-md-2","col-md-8","offset-lg-3","col-lg-6","d-flex","justify-content-center"],["type","file","accept",".json","multiple","",1,"form-control","my-3",3,"disabled","change"],["fileInput",""],["class","text-center text-danger",4,"ngIf"],["class","col-12 offset-md-2 col-md-8 offset-lg-3 col-lg-6",4,"ngIf"],["class","text-center my-3",4,"ngIf"],[1,"col-12","offset-md-2","col-md-8","offset-lg-3","col-lg-6","d-flex","justify-content-center","my-3"],[1,"btn","btn-secondary","me-3",3,"disabled","click"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-center","text-danger"],[1,"h6"],[1,"col-12","offset-md-2","col-md-8","offset-lg-3","col-lg-6"],[1,"h3"],[1,"list-group","rounded-0"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-wrap"],[1,"fa-solid","fa-trash","text-danger",3,"click"],[1,"text-center","my-3"],[1,"h4"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3,"Select a Quiz JSON File"),e.k0s(),e.j41(4,"div",3)(5,"input",4,5),e.bIt("change",function(l){return n.onFileSelected(l)}),e.k0s()(),e.DNE(7,g,3,1,"div",6),e.DNE(8,T,6,3,"div",7),e.DNE(9,E,3,1,"div",8),e.j41(10,"div",9)(11,"button",10),e.bIt("click",function(){return n.clearFiles()}),e.EFF(12,"Clear Files"),e.k0s(),e.j41(13,"button",11),e.bIt("click",function(){return n.startQuiz()}),e.EFF(14,"Start Quiz"),e.k0s()()()()),2&i&&(e.R7$(5),e.Y8G("disabled",n.questions.length>=n.MAX_QUESTIONS),e.R7$(2),e.Y8G("ngIf",n.errorMessage),e.R7$(1),e.Y8G("ngIf",n.quizzes.size>0),e.R7$(1),e.Y8G("ngIf",n.questions.length>0),e.R7$(2),e.Y8G("disabled",0===n.quizzes.size),e.R7$(2),e.Y8G("disabled",0===n.questions.length))},dependencies:[c.Sq,c.bT,c.lG,_],styles:[".fa-trash[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return t})()}];let v=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[f.iI.forChild(O),f.iI]})}}return t})();var A=a(541);let F=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[c.MD,v,A.G]})}}return t})()}}]);